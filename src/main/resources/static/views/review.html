<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>review</title>
    <link rel="stylesheet" href="../src/css/shared.css" />
    <link rel="stylesheet" href="../src/css/review.css" />
    <script src="../src/js/review.js" defer></script>
    <script src="../src/js/translate.js" defer></script>
    <script
      src="https://kit.fontawesome.com/b3f3cec821.js"
      crossorigin="anonymous"
    ></script>
    <style>
      /* 추가 스타일링 */
      .average-rating {
          margin-bottom: 20px;
          padding: 10px;
          border: 1px solid #ccc;
          border-radius: 5px;
          background-color: #f9f9f9;
      }
      .rating {
          color: gold; /* 별 색상 변경 */
      }
      .review-item {
          margin-bottom: 20px;
          padding: 10px;
          border: 1px solid #ccc;
          border-radius: 5px;
          background-color: #fff;
      }
  </style>
  </head>
  <body>
    <header>
      <div class="header-content">
        <a href="/main" style="text-decoration: none">
          <span class="logo">
            <img src="../src/assets/logo.png" alt="logo" />
            <h1 id="site_title" class="notranslate">Networker</h1>
          </span>
        </a>
        <div class="menu">
          <a href="/main" id="menu_home">홈</a>
          <a href="/views/news.html" id="menu_news">정보</a>
          <a href="/post/list" id="menu_board">자유게시판</a>
          <a href="/views/store.html" id="menu_store">스토어</a>
          <a href="/lawsupport/main" id="menu_law">법률지원</a>
          <a href="/views/review.html" id="menu_review">기업리뷰</a>
        </div>
        <div class="auth-buttons">
          <a href="/views/login.html" id="login">로그인</a>
          <a href="/views/signup.html" id="signup">회원가입</a>
          <div class="profile-icon">
            <a href="/views/profile.html" id="profile-size">
              <img src="../src/assets/profile.png" alt="Profile" />
            </a>
          </div>
          <div class="language-selector">
            <img
              src="../src/assets/earth_icon.png"
              alt="earth"
              class="earth-icon"
            />
            <label for="languageSelector"></label>
            <select id="languageSelector">
              <option value="en">English</option>
              <option value="ko" selected>한국어</option>
              <option value="zh">中文</option>
              <option value="ja">日本語</option>
              <option value="vi">Tiếng Việt</option>
              <option value="mn">Монгол</option>
              <option value="uk">українська мова</option>
            </select>
          </div>
        </div>
      </div>
    </header>

    <main>
      <section id="search-section">
        <div class="sort-search-bar">
          <div class="search-box-container">
            <form
              class="search-box"
              action="javascript:void(0);"
              method="get"
              onsubmit="filterProducts()"
            >
              <input
                class="search-text"
                type="text"
                placeholder="회사 이름을 입력하세요"
              />
              <button class="search-btn" type="submit">
                <i class="fa-solid fa-magnifying-glass"></i>
              </button>
            </form>
          </div>
        </div>
      </section>

      <section id="company">
        <div class="content">
          <div class="review-item">
            <a href="company1.html">
              <img
                id="item1"
                src="../src/assets/Solution Tech .png"
                alt="Worker Image"
              />
              <h3 class="item-name">솔루션 테크</h3>
            </a>
            <div class="review-content">
              <h2>
                <div class="rating">
                  <div id="solution-tech-average-rating">☆☆☆☆☆</div>
                  <!-- 평균 별점 표시 -->
                  <span id="solution-tech-average-score">0.0</span>
                  <!-- 평균 점수 표시 -->
                </div>
              </h2>
              <p class="solution-tech-latest-review-text">리뷰 없음</p>
              <!-- 최신 리뷰 표시 -->
              <a href="company1.html" class="more_free">더보기</a>
            </div>
          </div>
          <div class="review-item">
            <a href="company2.html">
              <img src="../src/assets/company1.png" alt="Worker Image" />
              <h3 class="item-name">넥스트 테크</h3>
            </a>
            <div class="review-content">
              <h2>
                <div class="rating">
                  <div id="next-tech-average-rating">☆☆☆☆☆</div>
                  <!-- 평균 별점 표시 -->
                  <span id="next-tech-average-score">0.0</span>
                  <!-- 평균 점수 표시 -->
                </div>
              </h2>
              <p class="next-tech-latest-review-text">리뷰 없음</p>
              <!-- 최신 리뷰 표시 -->
              <a href="company2.html" class="more_free">더보기</a>
            </div>
          </div>
          <div class="review-item">
            <a href="company3.html">
              <img src="../src/assets/company2.png" alt="Worker Image" />
              <h3 class="item-name">퓨처 솔루션즈</h3>
            </a>
            <div class="review-content">
              <h2>
                <div class="rating">
                  <div id="future-solutions-average-rating">☆☆☆☆☆</div>
                  <!-- 평균 별점 표시 -->
                  <span id="future-solutions-average-score">0.0</span>
                  <!-- 평균 점수 표시 -->
                </div>
              </h2>
              <p class="future-solutions-latest-review-text">리뷰 없음</p>
              <!-- 최신 리뷰 표시 -->
              <a href="company3.html" class="more_free">더보기</a>
            </div>
          </div>
          <div class="review-item">
            <a href="company4.html">
              <img
                id="item1"
                src="../src/assets/company3.png"
                alt="Worker Image"
              />
              <h3 class="item-name">에이스 인더스트리</h3>
            </a>
            <div class="review-content">
              <h2>
                <div class="rating">
                  <div id="ace-industry-average-rating">☆☆☆☆☆</div>
                  <!-- 평균 별점 표시 -->
                  <span id="ace-industry-average-score">0.0</span>
                  <!-- 평균 점수 표시 -->
                </div>
              </h2>
              <p class="ace-industry-latest-review-text">리뷰 없음</p>
              <!-- 최신 리뷰 표시 -->
              <a href="company4.html" class="more_free">더보기</a>
            </div>
          </div>
          <div class="review-item">
            <a href="company5.html">
              <img src="../src/assets/company4.png" alt="Worker Image" />
              <h3 class="item-name">글로벌 이노베이션</h3>
            </a>
            <div class="review-content">
              <h2>
                <div class="rating">
                  <div id="global-innovation-average-rating">☆☆☆☆☆</div>
                  <!-- 평균 별점 표시 -->
                  <span id="global-innovation-average-score">0.0</span>
                  <!-- 평균 점수 표시 -->
                </div>
              </h2>
              <p class="global-innovation-latest-review-text">리뷰 없음</p>
              <!-- 최신 리뷰 표시 -->
              <a href="company5.html" class="more_free">더보기</a>
            </div>
          </div>
          <div class="review-item">
            <a href="company6.html">
              <img src="../src/assets/company5.png" alt="Worker Image" />
              <h3 class="item-name">스마트 테크놀로지</h3>
            </a>
            <div class="review-content">
              <h2>
                <div class="rating">
                  <div id="smart-technology-average-rating">☆☆☆☆☆</div>
                  <!-- 평균 별점 표시 -->
                  <span id="smart-technology-average-score">0.0</span>
                  <!-- 평균 점수 표시 -->
                </div>
              </h2>
              <p class="smart-technology-latest-review-text">리뷰 없음</p>
              <!-- 최신 리뷰 표시 -->
              <a href="company6.html" class="more_free">더보기</a>
            </div>
          </div>
        </div>
      </section>
    </main>

    <footer>
      <div class="footer-container">
        <ul class="footer-btn">
          <li><a href="#">이용약관</a></li>
          <li>
            <a href="/views/privacy_Policy.html" style="font-weight: bold"
              >개인정보처리방침</a
            >
          </li>
          <li><a href="/views/inquire.html">문의/신고</a></li>
          <li><a href="/views/inquire.html">광고안내</a></li>
        </ul>
      </div>
    </footer>

    <script>
      document.addEventListener('DOMContentLoaded', function () {
    // 각 회사의 리뷰 데이터를 위한 객체
    const companyReviews = {
        'solution-tech': [],
        'next-tech': [],
        'future-solutions': [],
        'ace-industry': [],
        'global-innovation': [],
        'smart-technology': []
    };

    // 로컬 스토리지에서 리뷰 데이터 불러오기
    const reviews = JSON.parse(localStorage.getItem('reviews')) || [];

    // 각 회사의 ID에 따라 리뷰를 분류
    reviews.forEach(review => {
        // review 객체가 회사 ID를 가지고 있는지 확인
        if (review.companyId && companyReviews[review.companyId]) {
            companyReviews[review.companyId].push(review);
        }
    });

    // 각 회사별로 평균 별점과 최신 리뷰 업데이트
    Object.keys(companyReviews).forEach(companyId => {
        const companyReviewList = companyReviews[companyId];
        const averageRatingElement = document.getElementById(`${companyId}-average-rating`);
        const averageScoreElement = document.getElementById(`${companyId}-average-score`);
        const latestReviewTextElement = document.querySelector(`.${companyId}-latest-review-text`);

        if (companyReviewList.length === 0) {
            // 리뷰가 없는 경우 기본 값 설정
            averageRatingElement.innerHTML = '☆☆☆☆☆';
            averageScoreElement.innerHTML = '0.0';
            latestReviewTextElement.innerHTML = '리뷰 없음';
        } else {
            // 평균 별점 계산
            const totalRating = companyReviewList.reduce((sum, review) => sum + parseInt(review.rating), 0);
            const averageRating = (totalRating / companyReviewList.length).toFixed(1);
            const fullStars = '★'.repeat(Math.floor(averageRating));
            const halfStar = averageRating % 1 !== 0 ? '☆' : '';
            const emptyStars = '☆'.repeat(5 - Math.ceil(averageRating));

            // 최신 리뷰 가져오기
            const latestReview = companyReviewList[companyReviewList.length - 1];

            // 별점 평균 및 최신 리뷰 업데이트
            averageRatingElement.innerHTML = `${fullStars}${halfStar}${emptyStars}`;
            averageScoreElement.innerHTML = `${averageRating}`;
            latestReviewTextElement.innerHTML = latestReview.headline ? `"${latestReview.headline}"` : "리뷰 없음";
        }
    });
});

    </script>
  </body>
</html>
